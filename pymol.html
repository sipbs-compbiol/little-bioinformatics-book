<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Leighton Pritchard">

<title>A Little Book of Bioinformatics - 4&nbsp; PyMOL</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chimerax.html" rel="next">
<link href="./biological_structures.html" rel="prev">
<link href="./assets/images/cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./biological_structures.html">Biological Structures</a></li><li class="breadcrumb-item"><a href="./pymol.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">`PyMOL`</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">A Little Book of Bioinformatics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/sipbs-compbiol/little-bioinformatics-book" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface to <em>A Little Book of Bioinformatics</em></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Representing Biological Data</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Biological Databases</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Pairwise Sequence Alignment</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./multiple_sequence_alignment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multiple Sequence Alignment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mafft.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title"><code>MAFFT</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Biological Networks</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./biological_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Biological Structures</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pymol.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title"><code>PyMOL</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chimerax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title"><code>ChimeraX</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Signatures of Evolution</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#where-can-i-download-pymol" id="toc-where-can-i-download-pymol" class="nav-link active" data-scroll-target="#where-can-i-download-pymol"><span class="header-section-number">4.1</span> Where can I download <code>PyMOL</code>?</a></li>
  <li><a href="#using-pymol" id="toc-using-pymol" class="nav-link" data-scroll-target="#using-pymol"><span class="header-section-number">4.2</span> Using <code>PyMOL</code></a>
  <ul class="collapse">
  <li><a href="#pymol-layout" id="toc-pymol-layout" class="nav-link" data-scroll-target="#pymol-layout"><span class="header-section-number">4.2.1</span> <code>PyMOL</code> layout</a></li>
  </ul></li>
  <li><a href="#obtaining-structures" id="toc-obtaining-structures" class="nav-link" data-scroll-target="#obtaining-structures"><span class="header-section-number">4.3</span> Obtaining structures</a></li>
  <li><a href="#changing-the-appearance-of-the-structure" id="toc-changing-the-appearance-of-the-structure" class="nav-link" data-scroll-target="#changing-the-appearance-of-the-structure"><span class="header-section-number">4.4</span> Changing the appearance of the structure</a>
  <ul class="collapse">
  <li><a href="#rotating-the-molecule" id="toc-rotating-the-molecule" class="nav-link" data-scroll-target="#rotating-the-molecule"><span class="header-section-number">4.4.1</span> Rotating the molecule</a></li>
  <li><a href="#changing-molecule-colours" id="toc-changing-molecule-colours" class="nav-link" data-scroll-target="#changing-molecule-colours"><span class="header-section-number">4.4.2</span> Changing molecule colours</a></li>
  <li><a href="#hiding-elements-of-the-structure" id="toc-hiding-elements-of-the-structure" class="nav-link" data-scroll-target="#hiding-elements-of-the-structure"><span class="header-section-number">4.4.3</span> Hiding elements of the structure</a></li>
  <li><a href="#selecting-part-of-the-structure" id="toc-selecting-part-of-the-structure" class="nav-link" data-scroll-target="#selecting-part-of-the-structure"><span class="header-section-number">4.4.4</span> Selecting part of the structure</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/sipbs-compbiol/little-bioinformatics-book/edit/main/pymol.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/sipbs-compbiol/little-bioinformatics-book/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-PyMOL" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title"><code>PyMOL</code></span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><code>PyMOL</code> is a widely-used, open source molecular visualisation package, with paid-for (“incentive”) support and updates.</p>
<section id="where-can-i-download-pymol" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="where-can-i-download-pymol"><span class="header-section-number">4.1</span> Where can I download <code>PyMOL</code>?</h2>
<p>The official home of <code>PyMOL</code> is at Schrodinger Software, where you can download the “Incentive” version. This requires a licence, which is free for educational use, but not free for academic/commercial/research use.</p>
<ul>
<li><a href="https://pymol.org/2/">https://pymol.org/2/</a></li>
</ul>
<p>There is an open-source, freely-licensed version of <code>PyMOL</code>, also provided by Schrodinger Software. This can be downloaded from <code>GitHub</code> and self-compiled, or obtained through <code>homebrew</code>:</p>
<ul>
<li><a href="https://github.com/schrodinger/pymol-open-source">https://github.com/schrodinger/pymol-open-source</a></li>
<li><a href="https://formulae.brew.sh/formula/pymol">https://formulae.brew.sh/formula/pymol</a></li>
</ul>
</section>
<section id="using-pymol" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="using-pymol"><span class="header-section-number">4.2</span> Using <code>PyMOL</code></h2>
<p>Start the program from the application icon, or from the command-line (depending on which version you have installed), to obtain the landing screen (<a href="#fig-pymol_landing">Figure&nbsp;<span>4.1</span></a>).</p>
<div id="fig-pymol_landing" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/pymol/01-pymol_landing.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.1: <code>PyMOL</code> landing screen, for the Open Source version, on macOS.</figcaption>
</figure>
</div>
<section id="pymol-layout" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="pymol-layout"><span class="header-section-number">4.2.1</span> <code>PyMOL</code> layout</h3>
<p>Pymol is laid out approximately into four quadrants. Clockwise from top left in <a href="#fig-pymol_landing">Figure&nbsp;<span>4.1</span></a> we have:</p>
<ul>
<li>The <strong>interactive command window</strong>. At the bottom of this window is the command prompt <code>PyMOL &gt;</code>, where commands to control the visualisation can be typed and executed.</li>
<li>The next quadrant (top right) contains a set of <strong>function buttons</strong> providing a range of actions for control of the visualisation.</li>
<li>Below this is the <strong>object control panel</strong>, which is the main point-and-click interface for changing the way that molecules in the visualisation window appear, and below this is the mouse control legend to explain what your mouse/trackpad actions will achieve.</li>
<li>Finally, at bottom left, we have the <strong>main viewer window</strong>, where your molecule will be shown.</li>
</ul>
</section>
</section>
<section id="obtaining-structures" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="obtaining-structures"><span class="header-section-number">4.3</span> Obtaining structures</h2>
<p><code>PyMOL</code> can connect directly to <a href="https://www.rcsb.org/">RCSB/PDB</a> to download structural data, and can load structure files from your local storage.</p>
<section id="fetching-structures-from-rcsbpdb" class="level4" data-number="4.3.0.1">
<h4 data-number="4.3.0.1" class="anchored" data-anchor-id="fetching-structures-from-rcsbpdb"><span class="header-section-number">4.3.0.1</span> <code>fetch</code>ing structures from RCSB/PDB</h4>
<p>We will download a structure directly from <a href="https://www.rcsb.org/">RCSB/PDB</a>. To do this we will use the <strong>interactive command window</strong>. We also need to know the RCSB/PDB accession for the structure we want to view. Here, we will use the structure <a href="https://www.rcsb.org/structure/4I61"><code>4I61</code></a>, a trimer of PduB, a bacterial microcompartment protein.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
PduB makes biochemical factories inside cells.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><a href="https://www.uniprot.org/uniprotkb/F8DQ39/entry">PduB</a> is a protein that trimerises to form a structural unit that then combines with other similar structural units to enclose a volume within bacterial cells, to make a kind of “factory” for chemical reactions.</p>
<p>The UniProt entry for the protein corresponding to this structure is <a href="https://www.uniprot.org/uniprotkb/F8DQ39/entry">F8DQ39</a></p>
</div>
</div>
</div>
<p>To <code>fetch</code> this structure from RCSB/PDB, we enter the command <code>fetch 4I61</code> into the command prompt, and hit <code>Return</code> (<a href="#fig-pymol_fetch_cmd">Figure&nbsp;<span>4.2</span></a>).</p>
<div id="fig-pymol_fetch_cmd" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/pymol/02-pymol_fetch.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.2: <code>PyMOL</code> command prompt including <code>fetch</code> command.</figcaption>
</figure>
</div>
<p>Executing this command will produce a short report to the interactive command window, and show a rendering of the structure in the <strong>main viewer window</strong> (<a href="#fig-pymol_fetch_load">Figure&nbsp;<span>4.3</span></a>).</p>
<div id="fig-pymol_fetch_load" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/pymol/03-pymol_fetch_load.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.3: Initial render of <code>4I61</code> PduB structure in <code>PyMOL</code>.</figcaption>
</figure>
</div>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>PyMOL</code> downloads the fetched file.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When executed, this command will also download the file <code>4I61.cif</code> to the current working directory. You can load this file into <code>PyMOL</code> without requiring a live network connection.</p>
</div>
</div>
</div>
</section>
</section>
<section id="changing-the-appearance-of-the-structure" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="changing-the-appearance-of-the-structure"><span class="header-section-number">4.4</span> Changing the appearance of the structure</h2>
<section id="rotating-the-molecule" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="rotating-the-molecule"><span class="header-section-number">4.4.1</span> Rotating the molecule</h3>
<p>By default, left-clicking on the molecule in the main viewer window and moving your mouse will rotate the molecule. You can use this to obtain a viewing position that helps you understand the structure better or that, when saved as a figure, will communicate your message to a reader.</p>
</section>
<section id="changing-molecule-colours" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="changing-molecule-colours"><span class="header-section-number">4.4.2</span> Changing molecule colours</h3>
<p>The <strong>object control panel</strong> provides buttons (<code>A</code>, <code>S</code>, <code>H</code>, <code>L</code>, <code>C</code>) that control aspects of the molecule’s appearance:</p>
<ul>
<li><code>A</code>/Action</li>
<li><code>S</code>/Show</li>
<li><code>H</code>/Hide</li>
<li><code>L</code>/Label</li>
<li><code>C</code>/Colour</li>
</ul>
<p>There are three distinct protein chains in this trimeric structure. We will colour the protein differently by chain so that we can see them more clearly.</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>Click on the <code>C</code> button for <code>4I61</code> in the <strong>object control panel</strong></li>
<li>Click on <code>by chain</code> in the menu that appears</li>
<li>Click on <code>by chain</code> in the new menu</li>
</ul>
</div>
</div>
</div>
<p>This colours each chain in the structure differently, and also the water molecules (small dots) associated with each chain (<a href="#fig-pymol_by_chain">Figure&nbsp;<span>4.4</span></a>).</p>
<div id="fig-pymol_by_chain" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/pymol/04-pymol_by_chain.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.4: <code>PyMOL</code> rendering of <code>4I61</code> with a different colour for each chain.</figcaption>
</figure>
</div>
</section>
<section id="hiding-elements-of-the-structure" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="hiding-elements-of-the-structure"><span class="header-section-number">4.4.3</span> Hiding elements of the structure</h3>
<p>We sometimes want to focus attention on particular parts of a structure. To aid in this we can <em>hide</em> parts of the visualisation, using the <code>H</code>/Hide menu in the object control panel.</p>
<p>For example, to hide the water molecules that surround each chain, we would:</p>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<ul>
<li>Click on the <code>H</code> button for <code>4I61</code> in the object control panel</li>
<li>Click on <code>waters</code></li>
</ul>
</div>
</div>
</div>
<p>This removes the water molecules from our visualisation (<a href="#fig-pymol_hide_waters">Figure&nbsp;<span>4.5</span></a>).</p>
<div id="fig-pymol_hide_waters" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/pymol/05-pymol_hide_waters.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.5: <code>4I61</code> structure with waters removed.</figcaption>
</figure>
</div>
</section>
<section id="selecting-part-of-the-structure" class="level3" data-number="4.4.4">
<h3 data-number="4.4.4" class="anchored" data-anchor-id="selecting-part-of-the-structure"><span class="header-section-number">4.4.4</span> Selecting part of the structure</h3>
<p>It is possible to select parts of the structure in <code>PyMOL</code> by pointing and clicking using the mouse. For complicated selections especially, this can be difficult, tedious, and error-prone. It is usually better to use the <strong>interactive command window</strong> to select structural components explicitly.</p>
<section id="selecting-with-indicate" class="level4" data-number="4.4.4.1">
<h4 data-number="4.4.4.1" class="anchored" data-anchor-id="selecting-with-indicate"><span class="header-section-number">4.4.4.1</span> Selecting with <code>indicate</code></h4>
<p>Wo select only the first chain of the trimeric PduB structure (chain A), we could execute the command <code>indicate chain A</code>, which highlights that chain in the main visualisation window, to show that it is selected (<a href="#fig-pymol_chain_highlight">Figure&nbsp;<span>4.6</span></a>).</p>
<div class="{callout-note}">
<p>See that using <code>indicate</code> has produced a new row in the <strong>object control panel</strong> called <code>(indicate)</code>. This allows us to control the appearance of the selected element.</p>
</div>
<div id="fig-pymol_chain_highlight" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/pymol/06-pymol_chain_highlight.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.6: <code>4I61</code> structure with chain A highlighted.</figcaption>
</figure>
</div>
<p>With the chain selected, we can then change the way it is drawn using the <code>S</code>/Show menu for the <code>(indicate)</code> selection, and the colours used for rendering, using the corresponding <code>C</code>/Colour menu (<a href="#fig-pymol_show_spheres">Figure&nbsp;<span>4.7</span></a>, <a href="#fig-pymol_colour_spheres">Figure&nbsp;<span>4.8</span></a>).</p>
<div id="fig-pymol_show_spheres" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/pymol/07-pymol_show_spheres.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.7: Rendering <code>4I61</code> chain A structure as spheres.</figcaption>
</figure>
</div>
<div class="callout callout-style-simple callout-important">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Click on the <code>(indicate)</code> label in the object control panel to cancel the selection.</p>
</div>
</div>
</div>
<div id="fig-pymol_colour_spheres" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/pymol/08-pymol_colour_spheres.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.8: Rendering <code>4I61</code> chain A structure with atom colouring.</figcaption>
</figure>
</div>
</section>
<section id="selecting-specific-residues-with-the-sequence-viewer" class="level4" data-number="4.4.4.2">
<h4 data-number="4.4.4.2" class="anchored" data-anchor-id="selecting-specific-residues-with-the-sequence-viewer"><span class="header-section-number">4.4.4.2</span> Selecting specific residues with the sequence viewer</h4>
<p>Below the mouse action legend on the right hand side of the window there is a set of control buttons. To the right of this list is a button labelled with the letter <code>S</code>. Clicking this button brings up the sequence viewer/selector at the top of the main image visualisation window (<a href="#fig-pymol_seq_selector">Figure&nbsp;<span>4.9</span></a>).</p>
<div id="fig-pymol_seq_selector" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/pymol/09-pymol_seq_selector.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.9: Activating the sequence selector.</figcaption>
</figure>
</div>
<p>The scroll bar below the sequence allows you to find any part of the protein sequence (and additional molecules in the structure). The symbols are coloured to match the current structural representation, to aid with locating specific residues. For instance, in <span class="quarto-unresolved-ref">?fig-selecting_residues</span> the residues for chain <code>B</code> are coloured in cyan. Residues can be selected by clicking and dragging within the displayed sequence, and the current selection is highlighted as <code>(sele)</code> in the object control panel. We can also select discontinuous sections of the structure, as in <a href="#fig-pymol_discontinuous_selection">Figure&nbsp;<span>4.11</span></a>.</p>
<div id="fig-pymol_selecting_residues" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/pymol/10-pymol_selecting_residues.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.10: Selecting chain residues in <code>PyMOL</code> using the sequence viewer/selector</figcaption>
</figure>
</div>
<div id="fig-pymol_discontinuous_selection" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="assets/images/pymol/11-pymol_discontinuous_selection.png" class="img-fluid figure-img" style="width:75.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4.11: Selecting discontinuous residues in <code>PyMOL</code> using the sequence viewer/selector</figcaption>
</figure>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./biological_structures.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Biological Structures</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chimerax.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title"><code>ChimeraX</code></span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">This book was written by Leighton Pritchard.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.<br>
</div>
  </div>
</footer>



</body></html>